GEIH_adultos<-GEIH[!(GEIH$age>=18) | (GEIH$ocu==1),]
View(GEIH_adultos)
GEIH_adultos<-GEIH[!(GEIH$age>=18),]
#2.1 Variables de interés------------------------------
#Dejamos mayores de edad y trabajadores
GEIH_adultos<-data.frame()
GEIH_adultos<-GEIH[!(GEIH$age>=18| GEIH$ocu==1),]
View(GEIH_adultos)
View(GEIH_adultos)
#2.1 Variables de interés------------------------------
#Dejamos mayores de edad y trabajadores
GEIH_adultos<-data.frame()
GEIH_adultos<-GEIH[!(GEIH$age<18| GEIH$ocu=!1),]
# Authors: Pablo Cerezo Lesmes & Juan Sebasti??n Dur??n Dur??n
######################################################
#Por la fecha, el scraping se hizo siguiendo esta p??gina: https://datanalytics.com/libro_r/web-scraping.html
# 02. Data cleanning #
rm(list = ls())
url <-paste0("https://ignaciomsarmiento.github.io/GEIH2018_sample/pages/geih_page_1.html")
temp <- read_html(url)%>%
html_table()
geih <- temp
GEIH <- as.data.frame(geih)
GEIH_adultos<-data.frame()
GEIH_adultos<-subset(GEIH, age>=18 & ocu==1)
View(GEIH_adultos)
View(GEIH_adultos)
######################################################
#Problem Set 1: Predicting Income#
# Authors: Pablo Cerezo Lesmes & Juan Sebasti??n Dur??n Dur??n
######################################################
#Por la fecha, el scraping se hizo siguiendo esta p??gina: https://datanalytics.com/libro_r/web-scraping.html
# 02. Data cleanning #
rm(list = ls())
#Cargamos los paquetes necesarios----------------------
library(rio)
library(tidyverse)
library(e1071)
library(EnvStats)
library(tidymodels)
library(ggplot2)
library(scales)
library(ggpubr)
library(knitr)
library(kableExtra)
library(rvest)
library(pacman)
library(dplyr)
#Cargamos la data--------------------------------------
geih <- data.frame()
for (x in 1:10){
url <-paste0("https://ignaciomsarmiento.github.io/GEIH2018_sample/pages/geih_page_1.html")
temp <- read_html(url)%>%
html_table()
geih <- temp
GEIH <- as.data.frame(geih)
}
geih <- read_html("https://ignaciomsarmiento.github.io/GEIH2018_sample/pages/geih_page_1.html")%>%
html_table()
#2.1 Variables de interés------------------------------
#Dejamos mayores de edad y trabajadores
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1)
GEIH_ocupados <- GEIH_ocupados %>%
mutate(edad2 =edad^2)
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 =age^2)
View(GEIH_ocupados)
View(GEIH_ocupados)
GEIH_punto3 <- subset(GEIH_ocupados, select = c (age, age2))
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 =age^2,
age_sex =age*sex,
age_sex2 = age2*sex)
GEIH_punto4 <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, relab,
maxEducLevel))
View(GEIH)
View(GEIH)
rm(list = ls())
#Cargamos los paquetes necesarios----------------------
library(tidyverse)
library(rvest)
library(pacman)
library(dplyr)
library(readr, warn.conflicts = FALSE)
#Cargamos la data--------------------------------------
GEIH <- data.frame()
for (i in 1:10){
url <-paste0("https://ignaciomsarmiento.github.io/GEIH2018_sample/pages/geih_page_",i,".html")
temp <- read_html(url)%>%
html_table()
temp <- as.data.frame(temp)
GEIH <- rbind(GEIH,temp)
}
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1)
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
age_sex = age*sex,
age_sex2 = age2*sex,
ln_Ing = ln(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
)
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
age_sex = age*sex,
age_sex2 = age2*sex,
log_Ing = log(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
)
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, ln_Ing, formal_sex,
realb_sex))
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
#Creamos años de educación según máximo nivel educativo alcanzado
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0
)
View(GEIH_clean)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel=3, 4)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
summary(año_educ)
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
summary(años_educ)
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
summary(años_educ)
View(GEIH_ocupados)
View(GEIH_ocupados)
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1)
#Creamos interacciones de variables de interés
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
age_sex = age*sex,
age_sex2 = age2*sex,
log_Ing = log(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
)
#Creamos el df con las variables de interés
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
#Creamos años de educación según máximo nivel educativo alcanzado
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
#fin limpieza de la base
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
View(GEIH_clean)
#Creamos años de educación según máximo nivel educativo alcanzado
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
summarise(GEIH_clean$años_educ)
summarise(años_educ)
max(años_educ)
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
max(años_educ)
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
#Creamos años de educación según máximo nivel educativo alcanzado
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
max(años_educ)
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
#Creamos años de educación según máximo nivel educativo alcanzado
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
View(GEIH_ocupados)
rm(list = ls())
#Cargamos los pa
rm(list = ls())
#Cargamos los paquetes necesarios----------------------
library(tidyverse)
library(rvest)
library(pacman)
library(dplyr)
library(readr, warn.conflicts = FALSE)
#Cargamos la data--------------------------------------
GEIH <- data.frame()
for (i in 1:10){
url <-paste0("https://ignaciomsarmiento.github.io/GEIH2018_sample/pages/geih_page_",i,".html")
temp <- read_html(url)%>%
html_table()
temp <- as.data.frame(temp)
GEIH <- rbind(GEIH,temp)
}
#Fin del scraping
######################################################
# 2. Data cleaning #
####################################################
#2.1 Variables de interés------------------------------
#Dejamos mayores de edad y trabajadores
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1)
#Creamos interacciones de variables de interés
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
age_sex = age*sex,
age_sex2 = age2*sex,
log_Ing = log(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
)
#Creamos el df con las variables de interés
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
#Creamos años de educación según máximo nivel educativo alcanzado
GEIH_clean <- GEIH_clean %>%
mutate(años_educ=0)
GEIH_clean<- replace(GEIH_clean$años_educ, GEIH_clean$maxEducLevel==3, 4)
GEIH_clean <- subset(GEIH_ocupados, select = c (sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
#creamos tiempo de estudio de la persona de acuerdo con el
# nivel de educación alcanzado
GEIH_clean <- GEIH_clean  %>%
mutate(educ=0)
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 3] <- 4
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 4] <- 5
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 5] <- 10
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 6] <- 11
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 7] <-
#Creamos educ al cuadrado
GEIH_clean <- GEIH_clean  %>%
mutate(educ2=educ^2)
GEIH_clean <- GEIH_clean  %>%
mutate(educ=0)
GEIH_clean <- GEIH_clean %>%
mutate(educ=0)
GEIH_clean <- GEIH_clean %>%
mutate(educ=0
)
library(dplyr)
GEIH_clean <- GEIH_clean  %>%
mutate(educ2=educ^2)
GEIH_clean <- GEIH_clean %>%
mutate(educ=0)
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 3] <- 4
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 4] <- 5
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 5] <- 10
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 6] <- 11
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 7] <-
#Creamos educ al cuadrado
GEIH_clean <- GEIH_clean  %>%
mutate(educ2=educ^2)
summary(GEIH_clean$educ)
GEIH_clean <- GEIH_clean %>%
mutate(educ=0)
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 3] <- 4
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 4] <- 5
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 5] <- 10
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 6] <- 11
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 7] <- 15
#Creamos educ al cuadrado
GEIH_clean <- GEIH_clean  %>%
mutate(educ2=educ^2)
summary(GEIH_clean$educ)
summary(GEIH_clean$educ2)
install.packages("bootstrap")
#3.1 Peak age by bootstrap
install.packages("boot")
library(boot)
#3.1 Peak age by bootstrap
install.packages("boot")
library(boot)
#creamos una función para las estadísticas
#con las que haremos bootstrap
SE <- function(GEIH_clean, GEIH_clean){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = GEIH_clean))
}
boot(GEIH_clean, SE, R=1000)
install.packages("boot")
SE <- function(GEIH_clean, GEIH_clean){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = GEIH_clean))
}
boot(GEIH_clean, SE, R=1000)
library(boot)
SE <- function(GEIH_clean, GEIH_clean){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = GEIH_clean))
}
boot(GEIH_clean, SE, R=1000)
#con las que haremos bootstrap
SE <- function(GEIH_clean){
coef(lm(ingtot~age+age2, data=GEIH_clean))
}
boot(GEIH_clean, SE, R=1000)
#con las que haremos bootstrap
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = index))
}
boot(GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$ingtot)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[3]
b3<-coefs[4]
elast<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE2, R=1000)
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$ingtot)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[3]
b3<-coefs[4]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$ingtot)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$ingtot)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
library(boot)
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$age)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$age)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[3]
b3<-coefs[4]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
#con las que haremos bootstrap
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$age)){
f<-lm(ingtot~age+age2,data=GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
}
boot(data=GEIH_clean, SE, R=1000)
GEIH_clean<-GEIH_clean%>%
mutate(female=sex+1)
GEIH_clean['female'][GEIH_clean['female'] == 2] <- 0
library(tidyverse)
GEIH_clean<-GEIH_clean%>%
mutate(female=sex+1)
GEIH_clean['female'][GEIH_clean['female'] == 2] <- 0
modelo2<-lm(log_Ing~female)
modelo2<-lm(log_Ing~female, data=GEIH_clean)
GEIH_clean<-GEIH_clean%>%
mutate(female=sex+1)
summary(GEIH_clean$female)
GEIH_clean['female'][GEIH_clean['female'] == 2] <- 0
summary(GEIH_clean$female)
modelo2<-lm(ingtot~female, data=GEIH_clean)
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log10(ingtot))
modelo2<-lm(log_Ing~female, data=GEIH_clean)
library(boot)
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset =  index))
}
boot(data=GEIH_clean, SE, R=1000)
GEIH_clean <- subset(GEIH_ocupados, select = c ( Var.1, dominio, sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
GEIH_clean <- GEIH_clean  %>%
mutate(educ=0)
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 3] <- 4
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 4] <- 5
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 5] <- 10
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 6] <- 11
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 7] <- 15
#Creamos educ al cuadrado
GEIH_clean <- GEIH_clean  %>%
mutate(educ2=educ^2)
library(boot)
SE <- function(GEIH_clean, Var.1){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset =  Var.1))
}
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, Var.1){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = Var.1))
}
boot(data=GEIH_clean, SE, R=1000)
GEIH_clean <- GEIH_clean %>%
mutate(indice=1)
SE <- function(GEIH_clean, indice){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = indice))
}
GEIH_clean <- GEIH_clean %>%
mutate(indice=1)
SE <- function(GEIH_clean, indice){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = indice))
}
boot(data=GEIH_clean, SE, R=1000)
#con las que haremos bootstrap
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = index))
}
boot(data=GEIH_clean, SE, R=1000)
modelo2<-lm(log_Int~sex, data=GEIH_clean)
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
summary(log_Ing)
summary(GEIH_clean$log_Ing)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean),]
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean),]
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean),]
summary(ingtot)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
EIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_cleean$ingtot),]
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean$ingtot),]
summary(ingtot)
summary(GEIH_clean$ingtot)
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
summary(GEIH_clean$log_Ing)
GEIH_clean[GEIH_clean$ingtot==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean$ingtot),]
GEIH_clean[GEIH_clean$ingtot==0]<-NA
GEIH_clean <- filter(GEIH_clean, ingtot>0)
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
summary(GEIH_clean$log_Ing)
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
summary(modelo2)
library(boot)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~sex, data=GEIH_clean), data=GEIH_clean, subset = index))
}
boot(data=GEIH_clean, SE2, R=1000)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~sex, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
library(boot)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~sex, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1200)

elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$ingtot)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$ingtot)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
library(boot)
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$age)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$age)){
f<-lm(ingtot~age+age2,GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[3]
b3<-coefs[4]
elastpt<-b2+2*b3*age_bar
return(elastpt)
}
boot(data=GEIH_clean, SE, R=1000)
#con las que haremos bootstrap
SE <- function(GEIH_clean, index,
age_bar=mean(GEIH_clean$age)){
f<-lm(ingtot~age+age2,data=GEIH_clean,subset = index)
coefs<-f$coefficients
b2<-coefs[2]
b3<-coefs[3]
}
boot(data=GEIH_clean, SE, R=1000)
GEIH_clean<-GEIH_clean%>%
mutate(female=sex+1)
GEIH_clean['female'][GEIH_clean['female'] == 2] <- 0
library(tidyverse)
GEIH_clean<-GEIH_clean%>%
mutate(female=sex+1)
GEIH_clean['female'][GEIH_clean['female'] == 2] <- 0
modelo2<-lm(log_Ing~female)
modelo2<-lm(log_Ing~female, data=GEIH_clean)
GEIH_clean<-GEIH_clean%>%
mutate(female=sex+1)
summary(GEIH_clean$female)
GEIH_clean['female'][GEIH_clean['female'] == 2] <- 0
summary(GEIH_clean$female)
modelo2<-lm(ingtot~female, data=GEIH_clean)
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log10(ingtot))
modelo2<-lm(log_Ing~female, data=GEIH_clean)
library(boot)
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset =  index))
}
boot(data=GEIH_clean, SE, R=1000)
GEIH_clean <- subset(GEIH_ocupados, select = c ( Var.1, dominio, sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex))
GEIH_clean <- GEIH_clean  %>%
mutate(educ=0)
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 3] <- 4
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 4] <- 5
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 5] <- 10
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 6] <- 11
GEIH_clean['educ'][GEIH_clean['maxEducLevel'] == 7] <- 15
#Creamos educ al cuadrado
GEIH_clean <- GEIH_clean  %>%
mutate(educ2=educ^2)
library(boot)
SE <- function(GEIH_clean, Var.1){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset =  Var.1))
}
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, Var.1){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = Var.1))
}
boot(data=GEIH_clean, SE, R=1000)
GEIH_clean <- GEIH_clean %>%
mutate(indice=1)
SE <- function(GEIH_clean, indice){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = indice))
}
GEIH_clean <- GEIH_clean %>%
mutate(indice=1)
SE <- function(GEIH_clean, indice){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = indice))
}
boot(data=GEIH_clean, SE, R=1000)
#con las que haremos bootstrap
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = index))
}
boot(data=GEIH_clean, SE, R=1000)
modelo2<-lm(log_Int~sex, data=GEIH_clean)
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
summary(log_Ing)
summary(GEIH_clean$log_Ing)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean),]
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean),]
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean),]
summary(ingtot)
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
EIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_cleean$ingtot),]
GEIH_clean[GEIH_clean$log_Ing==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean$ingtot),]
summary(ingtot)
summary(GEIH_clean$ingtot)
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
summary(GEIH_clean$log_Ing)
GEIH_clean[GEIH_clean$ingtot==0]<-NA
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean$ingtot),]
GEIH_clean[GEIH_clean$ingtot==0]<-NA
GEIH_clean <- filter(GEIH_clean, ingtot>0)
GEIH_clean<-GEIH_clean%>%
mutate(log_Ing=log(ingtot))
summary(GEIH_clean$log_Ing)
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
summary(modelo2)
library(boot)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~sex, data=GEIH_clean), data=GEIH_clean, subset = index))
}
boot(data=GEIH_clean, SE2, R=1000)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~sex, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
library(boot)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~sex, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1200)
#Dejamos la base limpia
rm(list = ls())
#Cargamos los paquetes necesarios----------------------
library(tidyverse)
library(rvest)
library(pacman)
library(dplyr)
library(readr, warn.conflicts = FALSE)
library(broom)
#Cargamos la data--------------------------------------
GEIH <- data.frame()
for (i in 1:10){
url <-paste0("https://ignaciomsarmiento.github.io/GEIH2018_sample/pages/geih_page_",i,".html")
temp <- read_html(url)%>%
html_table()
temp <- as.data.frame(temp)
GEIH <- rbind(GEIH,temp)
}
library(rvest)
rm(list = ls())
GEIH <- data.frame()
for (i in 1:10){
url <-paste0("https://ignaciomsarmiento.github.io/GEIH2018_sample/pages/geih_page_",i,".html")
temp <- read_html(url)%>%
html_table()
temp <- as.data.frame(temp)
GEIH <- rbind(GEIH,temp)
}
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1)
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
age_sex = age*sex,
age_sex2 = age2*sex,
log_Ing = log(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
educ=0
)
GEIH_ocupados <- GEIH_ocupados  %>%
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 3] <- 4
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 4] <- 5
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 5] <- 10
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 6] <- 11
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 7] <- 15
mutate(educ2=educ^2)
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1)
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
age_sex = age*sex,
age_sex2 = age2*sex,
log_Ing = log(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
educ=0
)
View(GEIH_ocupados)
View(GEIH_ocupados)
GEIH_ocupados <- GEIH_ocupados  %>%
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 3] <- 4
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 4] <- 5
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 5] <- 10
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 6] <- 11
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 7] <- 15
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 3] <- 4
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 3] <- 4
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 4] <- 5
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 5] <- 10
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 6] <- 11
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 7] <- 15
GEIH_ocupados <- GEIH_ocupados
mutate(educ2=educ^2)
GEIH_ocupados <- GEIH_ocupados %>%
mutate(educ2=educ^2)
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1 & ingtot>0)
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean$ingtot),]
#Creamos interacciones de variables de interés
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
age_sex = age*sex,
age_sex2 = age2*sex,
log_Ing = log(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
educ=0,
female=sex+1
)
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 3] <- 4
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 4] <- 5
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 5] <- 10
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 6] <- 11
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 7] <- 15
GEIH_ocupdos['female'][GEIH_ocupados['female'] == 2] <- 0
GEIH_ocupados <- GEIH_ocupados %>%
mutate(educ2=educ^2)
GEIH_clean <- subset(GEIH_ocupados, select = c ( dominio, sex, ingtot, age, age2,
age_sex, age_sex2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex, educ, educ2,female ))
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean),]
GEIH_clean[complete.cases(GEIH_clean),]
View(GEIH_clean)
View(GEIH_clean)
summary(GEIH_clean$log_Ing)
GEIH_ocupados<-data.frame()
GEIH_ocupados<-subset(GEIH, age>=18 & ocu==1 & ingtot>0)
GEIH_clean<-GEIH_clean[complete.cases(GEIH_clean$ingtot),]
#Creamos interacciones de variables de interés
GEIH_ocupados <- GEIH_ocupados %>%
mutate(age2 = age^2,
log_Ing = log(ingtot),
formal_sex = formal*sex,
realb_sex = relab*sex,
educ=0,
female=sex+1
)
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 3] <- 4
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 4] <- 5
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 5] <- 10
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 6] <- 11
GEIH_ocupados['educ'][GEIH_ocupados['maxEducLevel'] == 7] <- 15
GEIH_ocupdos['female'][GEIH_ocupados['female'] == 2] <- 0
GEIH_ocupados <- GEIH_ocupados %>%
mutate(educ2=educ^2,
age_female=age*female,
age_female2=age2*female
)
GEIH_clean <- subset(GEIH_ocupados, select = c ( dominio, ingtot, age, age2,
age_female, age_female2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex, educ, educ2,female ))
GEIH_clean[complete.cases(GEIH_clean),]
install.packages("boot")
library(boot)
modelo1<-lm(ingtot~age+age2, GEIH_clean)
sumary(modelo1)
summary(modelo1)
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = index))
}
boot(data=GEIH_clean, SE, R=1000)
modelo1<-lm(ingtot~age+age2, GEIH_clean)
sumary(modelo1)
modelo1<-lm(ingtot~age+age2, GEIH_clean)
summary(modelo1)
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = index))
}
boot(data=GEIH_clean, SE, R=1000)
modelo2<-lm(log_Ing~sex, data=GEIH_clean)
summary(modelo2)
modelo2<-lm(log_Ing~female, data=GEIH_clean)
summary(modelo2)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~female, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
GEIH_clean[complete.cases(GEIH_clean),]
modelo1<-lm(ingtot~age+age2, GEIH_clean)
summary(modelo1)
SE <- function(GEIH_clean, index){
coef(lm(ingtot~age+age2, data=GEIH_clean, subset = index))
}
boot(data=GEIH_clean, SE, R=1000)
modelo2<-lm(log_Ing~female, data=GEIH_clean)
summary(modelo2)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~female, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
summary(GEIH_clean$dominio)
GEIH_bog<-filter(GEIH_clean, dominio=="BOGOTA")
GEIH_bog<-subset(GEIH_clean, dominio=="BOGOTA")
View(GEIH)
GEIH_mas<-subset(GEIH_clean, female==0)
GEIH_fem<-subset(GEIH_clean, female==1)
GEIH_mas<-subset(GEIH_clean, female==0)
summary(GEIH_clean$female)
GEIH_ocupados['female'][GEIH_ocupados['female'] == 2] <- 0
summary(GEIH_clean$female)
GEIH_clean <- subset(GEIH_ocupados, select = c ( dominio, ingtot, age, age2,
age_female, age_female2, formal,
relab,maxEducLevel, depto,
clase, p6426, log_Ing, formal_sex,
realb_sex, educ, educ2,female ))
summary(GEIH_clean$female)
GEIH_mas<-subset(GEIH_clean, female==0)
GEIH_fem<-subset(GEIH_clean, female==1)
modelo2_mas <- lm(log_Ing~female, data=GEIH_mas)
summary(modelo2_mas)
modelo2_fem <- lm(log_Ing~female, data=GEIH_fem)
summary(modelo2_fem)
#regresión hombres
modelo2_mas <- lm(log_Ing~age, data=GEIH_mas)
summary(modelo2_mas)
#regresión mujeres
modelo2_fem <- lm(log_Ing~age, data=GEIH_fem)
summary(modelo2_fem)
modelo2_mas <- lm(log_Ing~age, data=GEIH_mas)
summary(modelo2_mas)
SE2_mas <- function(GEIH_mas, index){
coef(lm(log_Ing~age, data=GEIH_mas), data=GEIH_mas, subset = index)
}
boot(data=GEIH_mas, SE2_mas, R=1000)
modelo2_fem <- lm(log_Ing~age, data=GEIH_fem)
summary(modelo2_fem)
SE2_fem <- function(GEIH_fem, index){
coef(lm(log_Ing~age, data=GEIH_fem), data=GEIH_fem, subset = index)
}
boot(data=GEIH_fem, SE2_fem, R=1000)
summary(modelo3)
modelo3<-lm(log_Ing~female+age+relab+formal+educ+p6426+, data=GEIH_clean)
summary(modelo3)
modelo3<-lm(log_Ing~female+age+relab+formal+educ+p6426, data=GEIH_clean)
summary(modelo3)
install.packages(huxtable)
library(huxtable)
<<<<<<< HEAD
huxtable(tabla1)
tabla1 <- data.frame()
tabla1
huxtable(tabla1)
summary(vardesc)
data.frame(table(GEIH_clean$female))
install.packages("tableone")
library(tableone)
vardesc <- c("sex","ingtot","age","formal","clase","educ")
tabla1 <- CreateTableOne(data = GEIH_clean, vars = vardesc)
tabla1
vardesc <- c("sex","ingtot","age","formal","clase","educ","p6426", "relab")
tabla1 <- CreateTableOne(data = GEIH_clean, vars = vardesc)
tabla1
GEIH:clean %>%
rename(p6426 = tiempo_tra)
library(tidyverse)
library(dplyr)
GEIH:clean %>%
rename(p6426 = tiempo_tra)
GEIH_clean %>%
rename(p6426 = tiempo_tra)
GEIH_clean %>%
rename(  tiempo_tra = p6426)
GEIH_clean %>%
rename(tiempo_tra = p6426, tipo_ocu  = relab, urbano = clase)
GEIH_clean  <- rename(tiempo_tra = p6426, tipo_ocu  = relab, urbano = clase)
GEIH_clean <- GEIH_clean %>%
rename(tiempo_tra = p6426, tipo_ocu  = relab, urbano = clase)
summay(GEIH_clean)
summary(GEIH_clean)
skim(GEIH_clean)
install.packages("skim")
library(skim)
library(skimr)
skim(GEIH_clean)
table(GEIH_clean$educ)
install.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
ggplot(GEIH_clean, aes(x = ingtot)) + geom_histogram()
ggplot(GEIH_clean, aes(x= as.factor(educ))) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
ggplot(GEIH_clean, aes(x= as.factor(sex))) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
ggplot(GEIH_clean, aes(x= as.factor(educ,sex))) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
ggplot(GEIH_clean, aes(x= as.factor(educ, fill = sex))) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
ggplot(GEIH_clean, aes(x= as.factor(educ), fill = sex )) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
as.datatable_widget(a)
install.packages("descr")
library(descr)
descr(GEIH_clean$ingtot)
GEIH_clean %>%
crosstab(educ, sex)
library(dplyr)
GEIH_clean %>%
crosstab(educ, sex)
crosstab(GEIH_clean$educ, GEIH_clean$sex)
crosstab(GEIH_clean$educ, GEIH_clean$sex, prop.c = TRUE)
factor(GEIH_clean$educ)
factor(GEIH_clean, levels = c("0", "4", "5", "10","11", "15" ))
factor(educ, levels = c("0", "4", "5", "10","11", "15"))
factor(GEIH_clean$educ, levels = c("0", "4", "5", "10","11", "15"))
labels(GEIH_clean$female) <- list("0" = "Hombre",
"1" = "Mujer")
library(tidyverse)
library(dplyr)
labels(GEIH_clean$female) <- list("0" = "Hombre",
"1" = "Mujer")
factor(GEIH_clean$educ,
labels = c("Ninguno", "Primaria_inc", "Primaria_com", "Secundaria_inc","Secundaria_com", "Educ_superior"))
ggplot(GEIH_clean, aes(x= as.factor(educ), fill = sex )) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
ggplot(GEIH_clean, aes(x= educ, fill = sex )) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
GEIH_clean <- factor(GEIH_clean$educ,
labels = c("Ninguno", "Primaria_inc", "Primaria_com", "Secundaria_inc","Secundaria_com", "Educ_superior"))
ggplot(GEIH_clean, aes(x= as.factor(educ), fill = sex )) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
library(ggplot2
ggplot(GEIH_clean, aes(x= as.factor(educ), fill = sex )) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
install.packages("ggplot2")
library(ggplot2)
ggplot(GEIH_clean, aes(x= as.factor(educ), fill = sex )) + geom_bar(width=0.5, colour="red", fill="skyblue") +
geom_text(aes(label=..count..), stat='count',position=position_dodge(0.9), vjust=-0.5,  size=5.0)
factor(GEIH_clean$educ)
grafica <- GEIH_clean
grafica <- add_labels(grafica$educ, labels = c( `Sin_educ`= 0,
`Primaria_inc` = 4,
`Primaria_com` = 5,
`Secundaria_inc`= 10,
`Secundaria_com`= 11,
`Terciaria` = 15))
library(tidyverse)
library(rvest)
library(pacman)
library(dplyr)
library(readr, warn.conflicts = FALSE)
library(broom)
grafica <- add_labels(grafica$educ, labels = c( `Sin_educ`= 0,
`Primaria_inc` = 4,
`Primaria_com` = 5,
`Secundaria_inc`= 10,
`Secundaria_com`= 11,
`Terciaria` = 15))
grafica = factor(c(0,4,5,10,11,15),labels=c("Ninguno", "Primaria_inc", "Primaria_com", "Secundaria_inc", "Secundaria_com", "Educacion_sup"))
grafica <- GEIH_clean
grafica <- factor(c(0,4,5,10,11,15),labels=c("Ninguno", "Primaria_inc", "Primaria_com", "Secundaria_inc", "Secundaria_com", "Educacion_sup"))
grafica <- GEIH_clean
grafica$educ <- factor(c(0,4,5,10,11,15),labels=c("Ninguno", "Primaria_inc", "Primaria_com", "Secundaria_inc", "Secundaria_com", "Educacion_sup"))
modelo1 <- lm(ingtot ~ age + age2,
data = GEIH_clean)
summary(modelo1)
=======
modelo2<-lm(log_Ing~female, data=GEIH_clean)
summary(modelo2)
huxreg(modelo2)
install.packages(huxtable)
install.packages(huxtable)
install.packages("huxtable")
library(huxtable)
modelo2<-lm(log_Ing~female, data=GEIH_clean)
summary(modelo2)
huxreg(modelo2)
modelo3<-lm(log_Ing~female+age+relab+formal+educ+p6426, data=GEIH_clean)
summary(modelo3)
huxtable(modelo3)
modelo3<-lm(log_Ing~female+age+relab+formal+educ+p6426, data=GEIH_clean)
summary(modelo3)
huxtable(modelo3)
huxreg(modelo3)
#regresión edad para hombres
modelo2_mas <- lm(log_Ing~age, data=GEIH_mas)
summary(modelo2_mas)
SE2_mas <- function(GEIH_mas, index){
coef(lm(log_Ing~age, data=GEIH_mas), data=GEIH_mas, subset = index)
}
boot(data=GEIH_mas, SE2_mas, R=1000)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~female, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
modelo2<-lm(log_Ing~female, data=GEIH_clean)
summary(modelo2)
#huxreg(modelo2)
#############Bootstrap
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~female, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
library(boot)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~female, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
###############Corremos el modelo
modelo2<-lm(log_Ing~female, data=GEIH_clean)
summary(modelo2)
SE2 <- function(GEIH_clean, index){
coef(lm(log_Ing~female, data=GEIH_clean), data=GEIH_clean, subset = index)
}
boot(data=GEIH_clean, SE2, R=1000)
SE2 <- function(GEIH_clean, index){
reg <- lm(log_Ing~female, data=GEIH_clean[index, ])
coef(reg)
}
boot(data=GEIH_clean, SE2, R=1000)
SE <- function(GEIH_clean, index){
Pablo <- lm(ingtot~age+age2, data=GEIH_clean[index, ])
}
boot(data=GEIH_clean, SE, R=1000)
SE <- function(GEIH_clean, index){
Pablo <- lm(ingtot~age+age2, data=GEIH_clean[index, ])
coef(Pablo)
}
boot(data=GEIH_clean, SE, R=1000)
modelo1<-lm(ingtot~age+age2, GEIH_clean)
summary(modelo1)
modelo1<-lm(ingtot~age+age2, GEIH_clean)
summary(modelo1)
library("ggplot2")
GEIH_clean <- GEIH_clean %>%
mutate(ingtotpr = predict(modelo1))
ggplot(GEIH_clean, aes(x=age, y=predict(modelo1))) + geom_point()
modelo1<-lm(ingtot~age+age2, GEIH_clean)
summary(modelo1)
install.packages("boot")
library(boot)
SE <- function(GEIH_clean, index){
Pablo <- lm(ingtot~age+age2, data=GEIH_clean[index, ])
coef(Pablo)
}
boot(data=GEIH_clean, SE, R=1000)
library(boot)
SE <- function(GEIH_clean, index){
Pablo <- lm(ingtot~age+age2, data=GEIH_clean[index, ])
coef(Pablo)
}
boot(data=GEIH_clean, SE, R=1000)
modelo1<-lm(ingtot~age+age2, GEIH_clean)
summary(modelo1)
grafica_sexo<-data.frame()
grafica_sexo<-predict(lm(log_Ing~age, data=GEIH_fem))
grafica_sexo<-data.frame()
View(grafica_sexo)
grafica_sexo<-data.frame()
grafica_sexo<- mutate(Fem=  predict(lm(log_Ing~age, data=GEIH_fem)))
library("tidiverse")
###################
library("tidyverse")
grafica_sexo<-data.frame()
grafica_sexo<- mutate(Fem=  predict(lm(log_Ing~age, data=GEIH_fem)))
grafica_sexo<-data.frame()
library("dplyr")
grafica_sexo<-data.frame()
grafica_sexo<- mutate(Fem=  predict(lm(log_Ing~age, data=GEIH_fem)))
grafica_sexo<-data.frame()
grafica_sexo<- GEIH_mas%>%{
mutate(Fem=  predict(lm(log_Ing~age, data=GEIH_fem)))
}
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
+ labs(x='Ingresos', y='Edad', title ='Grafico 1') +
geom_point(y=predict(modelo2_fem), colour=red) +
geom_point(col = "yellow", size = 0.5 )
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
#### se crea el valor predicho del ingreso total es decir el "y gorro"
library("ggplot2")
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
+ labs(x='Ingresos', y='Edad', title ='Grafico 2') +  geom_point(col = "yellow", size = 0.5 )
modelo2_mas <- lm(log_Ing~age, data=GEIH_mas)
predict(modelo2_mas)
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
ggplot(GEIH_clean, aes(x=age, y=predict(modelo1))) + geom_point()
ggplot(GEIH_clean, aes(x=age, y=predict(modelo1))) + geom_point()
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
ggplot(GEIH_clean, aes(x=age, y=predict(modelo2_mas))) + geom_point()
>>>>>>> 51b5a8b53a5c106eface63dd81758707aad8dc53
